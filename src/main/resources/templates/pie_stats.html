<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Template</title>
    <link rel="stylesheet" th:href="@{/styles/bootstrap.min.css}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/styles/style.css}">
</head>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<canvas id="myChart" style="width:100%"></canvas>

<div>

</div>
<h3>Currency Search Statistics from last 30 days</h3>

<div class="container p-5">

    <form class="form-inline" method="get" th:action="@{'/stats/currency/'}">

        <div class="form-check-inline">
            <label for="code" th:text="#{chart.currency}">Currency</label>
            <select class="form-control" name="code" id="code" style="width: 70px">
                <option th:each="code:${codes}" th:value="${code}" th:text="${code}"></option>
            </select>
        </div>

        <button class="btn btn-sm m-1 btn-secondary" type="submit" th:text="#{chart.button.submit}">Submit</button>

    </form>
</div>

<div class="container p-5">
    <script th:inline="javascript">


        let stats = /*[[${results}]]*/;
        var xValues = stats.map(stat => stat.code);
        var barColors = ['#e6194b', '#3cb44b', '#ffe119', '#4363d8', '#f58231', '#911eb4', '#46f0f0', '#f032e6', '#bcf60c', '#fabebe', '#008080', '#e6beff', '#9a6324', '#fffac8', '#800000', '#aaffc3', '#808000', '#ffd8b1', '#000075', '#808080', '#ffffff', '#000000'
        ];

        new Chart("myChart", {
            type: "pie",
            data: {
                labels: xValues,
                datasets: [{
                    data: stats.map(stat => stat.counter),
                    backgroundColor: barColors
                }]
            },
            options: {}
        });
    </script>
</div>

<header th:insert="fragments/general :: menu"></header>

<footer th:insert="fragments/general :: footer"></footer>

<script th:src="@{~/js/bootstrap.bundle.min.js}"></script>
</body>
</html>